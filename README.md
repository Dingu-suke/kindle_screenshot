# kindle_screenshot

### このアプリケーションについて

Mac の Kindle アプリを検知して、ウィンドウハンドルを操作するアプリケーションです。
ウィンドウハンドルを操作し、自動で Kindle 書籍のPDFを作成します。

##### [ 流れ ]
1. ウィンドウから書籍情報を入力
2. ページをめくる方向を選択
3. 必要であれば繰り返し数を入力 (同じページが検知されると自動的にストップします)
4. スクリーンショットしたい座標を入力
5. ボタンを押してスクリーンショットを開始

##### [ 仕様 ]

pngとしてページをスクリーンショット => 配列に格納 => ページめくり => 終了したらPDFを作成
ページめくりは、単なる矢印キーで行っているため Kindleアプリケーションがアクティブになっている必要があります。

[ 5. ボタンを押してスクリーンショットを開始 ] で自動的にアクティブになりますが、それ以降に別のアプリケーションをアクティブにするとページがめくられず終了してしまうので、実行中はpcに触らないようにしなければなりません。

スクリーンショット実行中にPCを触れないのはかなり不便ですので、今後はVirtualBox等を仕様して仮想PC内で行えるようにしようか検討中です。

また、Kindleアプリケーションの検知方法は、現在開かれているアプリケーションを一覧で取得しその中から "Kindle" という名前のものをアクティブにします。そのため、旧バージョンである Kindle Classic などは未対応です。


### 環境
- M1 MacBook 
- MacOS 14 sonoma
- Python: 3.11.7

モジュールをインストール
```
pip3 install pyautogui

pip3 install appkit

pip3 install img2pdf

```

main.py の実行で、tkinter のウィンドウが表示されます。
Pyinstaller モジュールをインストールすれば、実行ファイル化できます。
```
pip3 install Pyinstaller
Pyinstaller --onefile [ファイル名.py]
```


### [ その他 ]
Pythonのバージョンによっては Argument Error が発生することがあります。
これはコメントアウトなどが原因かもしれませんので、ご確認ください。

追記 : 86行目に、title_entry  # 参照渡し とありますが、pythonのバージョンや環境によっては、引数エラーが発生します。
その場合は、  # 参照渡し  というコメントアウトが原因です。 # 参照渡し  を消してください.

